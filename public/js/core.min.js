"use strict";function initData(){var a;$.each(sortData(track.ranges),function(b,c){if("undefined"!=typeof a){var d=moment(c.start).diff(moment(a),"days");track.shortestPeriod>d&&(track.shortestPeriod=d),track.longestPeriod<d&&(track.longestPeriod=d)}c.id!==track.currentPeriod&&(d=moment(c.end).diff(moment(c.start),"days")+1,track.shortestMenstruation>d&&(track.shortestMenstruation=d),track.longestMenstruation<d&&(track.longestMenstruation=d)),a=c.start})}function sortData(a){var b=a.slice();return b.sort(function(a,b){return a.start>b.start?1:a.start<b.start?-1:0}),b}var PERIOD_RANGES="period-ranges",PERIOD_CURRENT="period-current",track={TODAY:moment(new Date).format("YYYY-MM-DD"),ranges:null,currentPeriod:null,shortestPeriod:46,longestPeriod:0,shortestMenstruation:21,longestMenstruation:0};"undefined"!=typeof Storage?(track.currentPeriod=localStorage.getItem(PERIOD_CURRENT),null!==track.currentPeriod&&(track.currentPeriod=+track.currentPeriod),track.ranges=localStorage.getItem(PERIOD_RANGES),null===track.ranges?track.ranges=[]:(track.ranges=JSON.parse(track.ranges),initData())):alert("Sorry! No Web Storage support.."),track.updatePeriod=function(a,b){var d,c=1;if(track.ranges.length>0&&(d=track.ranges[track.ranges.length-1],c=d.id+1),null!==track.currentPeriod){c=track.currentPeriod;var e=track.findPreriodById(c);b===a&&(a=track.ranges[e].start),track.ranges[e]={id:c,start:a,end:b}}else{var e=track.findPeriodByStartDay(a);e>-1&&(a=track.ranges[e].start,c=track.ranges[e].id),track.TODAY>=a&&track.TODAY<=b&&(track.currentPeriod=c),e>-1?track.ranges[e]={id:c,start:a,end:b}:track.ranges.push({id:c,start:a,end:b})}if("undefined"!=typeof d){var f=moment(a).diff(moment(d.start),"days");(""===track.shortestPeriod||track.shortestPeriod>f)&&(track.shortestPeriod=f),(""===track.longestPeriod||track.longestPeriod<f)&&(track.longestPeriod=f)}"undefined"!=typeof Storage&&(localStorage.setItem(PERIOD_RANGES,JSON.stringify(track.ranges)),null!==track.currentPeriod&&localStorage.setItem(PERIOD_CURRENT,track.currentPeriod))},track.removeCurrentPeriod=function(){track.currentPeriod=null,localStorage.removeItem(PERIOD_CURRENT)},track.findPreriodById=function(a){return track.ranges.findIndex(function(b){return b.id==a})},track.findPeriodByStartDay=function(a){return track.ranges.findIndex(function(b){return b.start==a})};